<!DOCTYPE html>
<html>

<head>
  <title>Project Management</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.0/angular-material.min.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

  <!-- Google Fonts API -->
  <link href="https://fonts.googleapis.com/css?family=Gugi" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Rancho&effect=shadow-multiple|3d-float">

  <!-- Custom stylesheets -->
  <link rel='stylesheet' href='/stylesheets/style.css' />
  <link rel='stylesheet' href='/stylesheets/comments.css' />

  

</head>

<body>
  <!-- Angular Material requires Angular.js Libraries -->
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-animate.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-route.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-aria.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-messages.min.js"></script>

  <!-- Angular Material Library -->
  <script src="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.0/angular-material.min.js"></script>

  <!-- My Angular script -->
  <!-- <script src="javascripts/angularScript.js"></script> -->

  <% var title='Sprint dashboard' %>
  <% var name= sprint.name %>
  <% var description=sprint.description %>

  <% include header-template.ejs %>
      <div class="container col-md-12">
          <div class="row">

            <div class="col-md-8">
                <div class="container col-md-12">
                    <% for(var i = 0; i < tasks.length; ) {%>
                    
                      <div class="row" >

                        <% for(var j = 0; j < 3 && i < tasks.length; ++j, ++i) {%>
                        <% var url = "../task/"+tasks[i].task_id %>
                        <div class="col-md-4">
                            <a href=<%= url %>>
                            <div class="box effect1">
                                <h3><%=tasks[i].name%></h3>
                                <h4>Status: <%=tasks[i].status%></h4>
                            </div>
                            </a>
                        </div>

                        <% } %>
                    </div>
                    <% } %>

                </div>
            </div>

            <div class="col-md-1">
                
            </div>

            <div class="col-md-4">

                <div class="container col-md-12">
                    <div class="row">
                      <div class="col-md-11">
                
                        <button type="button" class="btn btn-primary btn-lg btn-block menuButtons" data-toggle="modal" data-target="#taskModal">Create Task</button>
                
                        <button type="button" class="btn btn-primary btn-lg btn-block menuButtons" data-toggle="modal" data-target="#sprintModal">Update Sprint information</button>
                
                        <% var backURL = "../project/"+project.project_id %>
                        <a href="<%= backURL %>">
                        <button type="button" class="btn btn-primary btn-lg btn-block menuButtons"><span class="glyphicon glyphicon-chevron-left"></span> Project Dashboard </button> 
                        </a>
                      </div>
                    </div>

                    <div class="row">
                      <div class="col-md-12">
                      <!--Html code for comments-->
                                  <div class="detailBox">
                                    <div class="titleBox">
                                      <label>Comments</label>
                                      <button type="button" class="close" aria-hidden="true">&times;</button>
                                    </div>
                                    <div class="commentBox">
                                  
                                      <p class="taskDescription">Comments on the current sprint.</p>
                                      <div class="actionBox">
                                        <ul class="commentList">
                                          <li>
                                            <div class="commenterImage">
                                              <img src="http://placekitten.com/50/50" />
                                            </div>
                                            <div class="commentText">
                                              <p class="">Hello this is a test comment.</p>
                                              <span class="date sub-text">on March 5th, 2014</span>
                                  
                                            </div>
                                          </li>
                                  
                                          <li>
                                            <div class="commenterImage">
                                              <img src="http://placekitten.com/40/40" />
                                            </div>
                                            <div class="commentText">
                                              <p class="">Hello this is a test comment.</p>
                                              <span class="date sub-text">on March 5th, 2014</span>
                                  
                                            </div>
                                          </li>
                                        </ul>
                                        <% var urlcomment = "/sprint/"+sprint.sprint_id+"/AddSprintComment" %>
                                        
                                        <form class="form-inline" role="form" method="POST" action="<%= urlcomment %>">
                                          <div class="form-group">
                                            <input class="form-control" type="text" placeholder="Your comments" name="content" />
                                          </div>
                                          <div class="form-group">
                                            <button type="submit" class="btn btn-default">Add</button>
                                          </div>
                                        </form>
                                      </div>
                                    </div>
                        </div>
                    </div>

                </div>
            </div>
          </div>
        </div>

  


















<!-- Create Task MODAL -->

  <div class="modal fade" id="taskModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">

        <div class="modal-body">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="margin:15px 15px;">
            <span aria-hidden="true">&times;</span>
          </button>
          <div class="panel-heading">
            <div class="font-effect-shadow-multiple heading">Create Task</div>
          </div>
          <hr>
          <% var url1 = "/sprint/"+sprint.sprint_id+"/AddTask" %>
          <form name="taskForm" class="form-signin" role="form" method="post" action="<%= url1 %>" id="taskForm">


            <label>Name</label>
            <input type="text" class="form-control" name="name" required>
            <br />

            <label>Assigned to</label>
            <select class="form-control" id="dropdown" name="assignee">
                <option>No one yet</option>
                <% for(var i = 0; i < project.members.length; ++i) {%>
                  <option><%= project.members[i] %></option>
                  <% } %>
                </select>


            <label>Task description</label>
            <textarea class="form-control" rows="4" name="description" required></textarea>
            <br />

            <div class="container col-md-12">
              <div class="row">

                <div class="col-md-5">
                  <label for="startDate">Start Date:</label>
                  <input class="form-control" type="date" id="startDate" name="startDate" required>
                </div>

                <div class="col-md-2">

                </div>


                <div class="col-md-5">
                  <label for="endDate">End Date:</label>
                  <input class="form-control" type="date" id="endDate" name="endDate" required>
                  <br />
                </div>
              </div>
            </div>


            <div class="submitButton">
              <button type="submit" class="btn btn-primary">Create Task</button>
            </div>
          </form>
        </div>

      </div>
    </div>
  </div>

  <!-- Update Sprint Modal -->
  <div class="modal fade" id="sprintModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">

        <div class="modal-body">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="margin:15px 15px;">
            <span aria-hidden="true">&times;</span>
          </button>
          <div class="panel-heading">
            <div class="font-effect-shadow-multiple heading">Update Sprint</div>
          </div>
          <hr>
          <% var url2 = "/sprint/"+sprint.sprint_id+"/UpdateSprint" %>
            <form name="sprintForm" class="form-signin" role="form" method="post" action="<%=url2%>" id="sprintForm">


              <label>Name</label>
              <input type="text" class="form-control" name="name" value="<%= sprint.name %>" required>
              <br />


              <label>Description:</label>
              <textarea class="form-control" rows="5" name="description" required><%= sprint.description %></textarea>
              <br />

              <label>Sprint status</label>
              <select class="form-control" id="dropdown_status" name="status">
                  <option value='To-do'>To-do</option>
                  <option value='In-progress'>In-progress </option>
                  <option value='Completed'>Completed</option>
                  </select>

                  <br />

              <div class="container col-md-12">
                <div class="row">

                  <div class="col-md-5">
                    <label for="startDate">Start Date:</label>
                    <input class="form-control" type="date" name="startDate" id="sprint_startDate" required>
                  </div>

                  <div class="col-md-2">

                  </div>


                  <div class="col-md-5">
                    <label for="endDate">End Date:</label>
                    <input class="form-control" type="date" name="endDate" id="sprint_endDate" required>
                    <br />
                  </div>
                </div>
              </div>


              <div class="submitButton">
                <button type="submit" class="btn btn-primary">Update Sprint</button>
              </div>
            </form>
        </div>

      </div>
    </div>
  </div>

      <!--Html code for comments-->
      <!-- <div class="detailBox">
        <div class="titleBox">
          <label>Comments</label>
          <button type="button" class="close" aria-hidden="true">&times;</button>
        </div>
        <div class="commentBox">
      
          <p class="taskDescription">Comments on the current sprint.</p>
          <div class="actionBox">
            <ul class="commentList">
              <li>
                <div class="commenterImage">
                  <img src="http://placekitten.com/50/50" />
                </div>
                <div class="commentText">
                  <p class="">Hello this is a test comment.</p>
                  <span class="date sub-text">on March 5th, 2014</span>
      
                </div>
              </li>
      
              <li>
                <div class="commenterImage">
                  <img src="http://placekitten.com/40/40" />
                </div>
                <div class="commentText">
                  <p class="">Hello this is a test comment.</p>
                  <span class="date sub-text">on March 5th, 2014</span>
      
                </div>
              </li>
            </ul>
            <form class="form-inline" role="form">
              <div class="form-group">
                <input class="form-control" type="text" placeholder="Your comments" />
              </div>
              <div class="form-group">
                <button class="btn btn-default">Add</button>
              </div>
            </form>
          </div>
        </div> -->
        <!-- Html code for comments end here-->
        

  <script>
    $(document).ready(function () {

      let start_date = new Date('<%- sprint.start_date %>').toISOString().substr(0, 10);
      let end_date = new Date('<%- sprint.end_date %>').toISOString().substr(0, 10);
      document.querySelector("#sprintForm #sprint_startDate").value = start_date;
      document.querySelector("#sprintForm #sprint_endDate").value = end_date;

      $("#dropdown_status").val('<%- sprint.status %>');

      $("#endDate").change(function () {
        var startDate = document.getElementById("startDate").value;
        var endDate = document.getElementById("endDate").value;

        if ((Date.parse(endDate) <= Date.parse(startDate))) {
          alert("End date should be greater than Start date");
          document.getElementById("endDate").value = "";
        }
      });
    });
  </script>

</body>

</html>