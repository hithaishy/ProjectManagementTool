<!DOCTYPE html>
<html>

<head>
  <title>
      Profile
  </title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.0/angular-material.min.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

  <!-- Google Fonts API -->
  <link href="https://fonts.googleapis.com/css?family=Gugi" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Rancho&effect=shadow-multiple|3d-float">

   <!-- Bootstrap core CSS -->
   <link href="/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom stylesheets -->
  <link rel='stylesheet' href='/stylesheets/style.css' />
  <link rel='stylesheet' href='/stylesheets/style2.css' />
</head>

<body>
  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <!-- Plugin JavaScript -->
  <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

  <!-- Angular Material requires Angular.js Libraries -->
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-animate.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-route.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-aria.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-messages.min.js"></script>

  <!-- Angular Material Library -->
  <script src="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.0/angular-material.min.js"></script>

  <!-- My Angular script -->
  <script src="javascripts/angularScript.js"></script>

   <!--Navigation -->
   <nav class="navbar navbar-expand-lg navbar-dark fixed-top" id="mainNav">
      <div class="container">
        
          
        <a class="navbar-brand js-scroll-trigger" href="#page-top" id="linktotop" font-size="15px">Welcome
            <%=user.name %></a>
        
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav text-uppercase ml-auto">
              <li class="nav-item">
                  <a class="nav-link js-scroll-trigger" href="#projectModal" data-toggle="modal">Create Project</a>
                </li>
            <li class="nav-item">
              <a class="nav-link js-scroll-trigger" href="../logout">Signout</a>
            </li>
            <li class="nav-item">
                <a class="nav-link js-scroll-trigger" href="#"  data-toggle="modal" data-target="#userModal">Update Me</a>
              </li>
          </ul>
        </div>
      </div>
    </nav>
    
  <!--
  <h1>
    Creation of Project
  </h1>
  <h2>Welcome
    <%=user.name %>
  </h2>
   <p>Welcome to <%= title %></p> 
  <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#projectModal">
    Create Project
  </button>
-->
  <div class="modal fade" id="projectModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">

        <div class="modal-body">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="margin:15px 15px;">
            <span aria-hidden="true">&times;</span>
          </button>
          <div class="panel-heading">
            <div class="font-effect-shadow-multiple heading">CREATE PROJECT :)</div>
          </div>
          <hr>


          <form name="projectForm" class="form-signin" role="form" action="profile/InsertProject" method="post" id="projectForm">



            <label>Name</label>
            <input type="text" class="form-control" name="name" required >
            <br />


            <label>Project description</label>
            <textarea class="form-control" rows="5" name="description" required ></textarea>
            <br />

            <label>Add Team members</label>&nbsp;&nbsp;&nbsp;

            <button type="button" class="btn btn-default add" aria-label="Left Align"> <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> </button> &nbsp;
            <button type="button" class="btn btn-default remove" aria-label="Left Align"> <span class="glyphicon glyphicon-remove" aria-hidden="true"></span> </button>
            
            <div class="membersClass">
            <input type="text" class="form-control memberItem">
            </div>
            
            <input type="text" style="display: none;" name="member" id="members"/>
            

            <!-- <input type="text" class="form-control" name="member" id="members"> -->
            <br />


            <div class="container col-md-12">
              <div class="row">

                <div class="col-md-5">

                  <label for="startDate">Start Date:</label>
                  <input class="form-control" type="date" name="startDate" id="startDate" required>
                </div>

                <div class="col-md-2">

                </div>


                <div class="col-md-5">

                  <label for="endDate">End Date:</label>
                  <input class="form-control" type="date" name="endDate" id="endDate" required>
                  <br />
                </div>
              </div>
            </div>


            <div class="submitButton">
              <button type="submit" class="btn btn-primary">Create Project</button>
            </div>
          </form>
        </div>

      </div>
    </div>
  </div>

  <div class="modal fade" id="userModal" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
  
          <div class="modal-body">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="margin:15px 15px;">
              <span aria-hidden="true">&times;</span>
            </button>
            <div class="panel-heading">
              <div class="font-effect-shadow-multiple heading">Update my profile :)</div>
            </div>
            <hr>
  
  
            <form name="userForm" class="form-signin" role="form" action="profile/UpdateUser" method="post" id="userForm">
  
  
  
              <label>Name</label>
              <input type="text" class="form-control" name="name" value="<%= user.name %>" required >
              <br />
  
              <label>University</label>
              <input type="text" class="form-control" name="name" value="<%= user.university %>" required >
              <br />
  
              <label>Description</label>
              <textarea class="form-control" rows="2" name="description" required ><%= user.description %></textarea>
              <br />  
              
              <!-- <input type="text" class="form-control" name="member" id="members"> -->
              <br />
  
              <div class="submitButton">
                <button type="submit" class="btn btn-primary">Update Me</button>
              </div>
            </form>
          </div>
  
        </div>
      </div>
    </div>

  <!-- JQuery scripting for modal bootstrap-->

  <script>
    $(document).ready(function () {

      $(".add").click(function(){
        $(".membersClass").append('<input type="text" class="form-control memberItem">');
    });

    $(".remove").click(function(){
      var parent = $(".membersClass");
    	if($(parent).children().length > 1)
    		$(parent).children().last().remove();
    });

      function validateMember() {
        var members = document.getElementById("members").value;
        var list = members.split(',');
        for (var index in list) {
          var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
          var flag = re.test(String(list[index]).toLowerCase());
          if (flag == false)
            return false;
        }
        return true;
      }

      $("#endDate").change(function () {
        var startDate = document.getElementById("startDate").value;
        var endDate = document.getElementById("endDate").value;
        if ((Date.parse(endDate) <= Date.parse(startDate))) {
          alert("End date should be greater than Start date");
          document.getElementById("endDate").value = "";
        }
      });
      
      $('#projectForm').submit(function (e) {
        var m = "";
        $('.membersClass').children().each(function () {
          m += this.value + ",";
        });
        
        $('#members').val(m.substring(0, m.length-1));

        if(!validateMember()){
          alert("Enter valid email ID")
          e.preventDefault();
        }
       
       //alert("hello");
      });
      
    });
  </script>

<div class="panel-heading" paddiing-top="10px">
  <div id="profilehead" class="font-effect-shadow-multiple heading">LIST OF PROJECTS</div>
</div>

<div class="container3">
      
  <% for(var i = 0; i < projects.length; ++i) {%>
<% var url = "../project/"+projects[i].project_id %>
   
      
    
    <div class="fancy2">
        <a href=<%= url %>>
          <h3>
        - <%=projects[i].name%>
    </h3></a>
    <h4>
        - <%=projects[i].lead%>
    </h4>
    </div>
  
    <% } %>

</div>
</body>

</html>